# Walkthrough - Epoch 9: Phase 4 (Dogfooding)

## Overview

This phase focused on ensuring the documentation site (`site/`) serves as a "Dogfooding" environment for the color system. By consuming the system's own generated tokens instead of hardcoded values, we ensure that the documentation always reflects the true state of the system and acts as a continuous integration test.

## Changes

### 1. Token Generation Strategy

- Verified that `site/package.json` includes a `generate:theme` script that runs the CLI against `site/color-config.json`.
- Confirmed that `site/astro.config.mjs` imports the generated `src/styles/theme.css`.
- This ensures that every build of the site uses a fresh, valid theme generated by the current version of the system.

### 2. Component Refactoring

We audited the codebase for hardcoded color values (Hex, RGB, HSL) and replaced them with semantic system tokens.

- **HueShiftVisualizer**: Replaced hardcoded syntax highlighting colors (`#3b82f6`, `#22c55e`, `#ec4899`) with chart tokens (`var(--chart-4)`, `var(--chart-3)`, `var(--chart-8)`).
- **DynamicRange**: Replaced Starlight-specific variables (`--sl-color-bg-nav`, etc.) with system surfaces (`var(--surface-workspace)`, `var(--text-token)`).
- **Solver Internals Guide**: Updated the "Linear Contrast" visualization to use actual system surfaces (`.surface-page`, `.surface-action`) instead of hardcoded `oklch` values. This now accurately demonstrates the system's contrast distribution.

### 3. Linting

To prevent regression, we added a `lint:colors` script to `site/package.json`.

```bash
pnpm lint:colors
```

This script greps for hex/rgb/hsl patterns in `src/components` and `src/content/docs` (excluding `theme.css`) and fails the build if any are found. This enforces the "Dogfooding" policy automatically.
