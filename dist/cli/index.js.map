{"version":3,"sources":["../../src/cli/commands/export.ts","../../src/cli/index.ts"],"names":["args","writeFileSync","resolve","readFileSync"],"mappings":"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","file":"index.js","sourcesContent":["import { readFileSync, writeFileSync } from \"node:fs\";\nimport { resolve } from \"node:path\";\nimport { toDTCG } from \"../../lib/exporters/dtcg.ts\";\nimport { toTailwind } from \"../../lib/exporters/tailwind.ts\";\nimport { solve } from \"../../lib/index.ts\";\nimport type { SolverConfig } from \"../../lib/types.ts\";\n\nexport function exportCommand(args: string[], cwd: string): void {\n  // Simple arg parsing\n  // color-system export --config <file> --out <file> --format <format>\n\n  let configPath = \"color-config.json\";\n  let outPath = \"\"; // Will be set based on format if not provided\n  let format = \"dtcg\";\n\n  for (let i = 0; i < args.length; i++) {\n    const nextArg = args[i + 1];\n    if (args[i] === \"--config\" && nextArg) {\n      configPath = nextArg;\n      i++;\n    } else if (args[i] === \"--out\" && nextArg) {\n      outPath = nextArg;\n      i++;\n    } else if (args[i] === \"--format\" && nextArg) {\n      format = nextArg;\n      i++;\n    }\n  }\n\n  // Set default output path if not provided\n  if (!outPath) {\n    if (format === \"dtcg\") {\n      outPath = \"tokens.json\";\n    } else if (format === \"tailwind\") {\n      outPath = \"tailwind.preset.js\";\n    }\n  }\n\n  const absConfigPath = resolve(cwd, configPath);\n  const absOutPath = resolve(cwd, outPath);\n\n  if (format !== \"dtcg\" && format !== \"tailwind\") {\n    console.error(\n      `Error: Unsupported format '${format}'. Supported formats: 'dtcg', 'tailwind'.`\n    );\n    process.exit(1);\n  }\n\n  console.log(`Reading config from: ${absConfigPath}`);\n  let config: SolverConfig;\n  try {\n    config = JSON.parse(readFileSync(absConfigPath, \"utf8\")) as SolverConfig;\n  } catch (e) {\n    console.error(`Error reading config file: ${String(e)}`);\n    process.exit(1);\n  }\n\n  console.log(\"Solving theme...\");\n  const theme = solve(config);\n\n  console.log(`Exporting to ${format.toUpperCase()}...`);\n  let outputContent = \"\";\n\n  if (format === \"dtcg\") {\n    const tokens = toDTCG(theme);\n    outputContent = JSON.stringify(tokens, null, 2);\n  } else if (format === \"tailwind\") {\n    const preset = toTailwind(theme);\n    // Output as CommonJS module\n    outputContent = `module.exports = ${JSON.stringify(preset, null, 2)};`;\n  }\n\n  console.log(`Writing to: ${absOutPath}`);\n  writeFileSync(absOutPath, outputContent);\n  console.log(\"Done!\");\n}\n","#!/usr/bin/env node\nimport { existsSync, readFileSync, writeFileSync } from \"node:fs\";\nimport { join, resolve } from \"node:path\";\nimport { generateTokensCss, toHighContrast } from \"../lib/generator.ts\";\nimport { getKeyColorStats, solve } from \"../lib/index.ts\";\nimport type { SolverConfig } from \"../lib/types.ts\";\nimport { exportCommand } from \"./commands/export.ts\";\nimport { DEFAULT_CONFIG } from \"./default-config.ts\";\n\nconst args = process.argv.slice(2);\nconst CWD = process.cwd();\n\nif (import.meta.main) {\n  if (args[0] === \"init\") {\n    const targetPath = join(CWD, \"color-config.json\");\n    if (existsSync(targetPath)) {\n      console.error(\"Error: color-config.json already exists.\");\n      process.exit(1);\n    }\n    const configWithSchema = {\n      $schema: \"./node_modules/color-system/color-config.schema.json\",\n      ...DEFAULT_CONFIG,\n    };\n    writeFileSync(targetPath, JSON.stringify(configWithSchema, null, 2));\n    console.log(\"Created color-config.json\");\n    console.log(\"Run `color-system` to generate your theme.\");\n    process.exit(0);\n  }\n\n  if (args[0] === \"export\") {\n    exportCommand(args.slice(1), CWD);\n    process.exit(0);\n  }\n\n  const CONFIG_PATH = args[0]\n    ? resolve(CWD, args[0])\n    : join(CWD, \"color-config.json\");\n\n  const BASE_CSS_PATH = args[1]\n    ? resolve(CWD, args[1])\n    : join(CWD, \"theme.css\");\n\n  if (!args[0] && !args[1]) {\n    // Check if default config exists, if not, warn\n    try {\n      readFileSync(CONFIG_PATH);\n    } catch {\n      console.error(\n        \"No config file found at default location: ./color-config.json\"\n      );\n      console.error(\"Usage: color-system [config-file] [output-file]\");\n      console.error(\"   or: color-system init\");\n      console.error(\"   or: color-system export --format dtcg\");\n      process.exit(1);\n    }\n  }\n\n  console.log(\"Reading config from:\", CONFIG_PATH);\n  const config = JSON.parse(readFileSync(CONFIG_PATH, \"utf8\")) as SolverConfig;\n\n  console.log(\"Solving surfaces...\");\n  const { backgrounds } = solve(config);\n\n  console.log(\"Generating CSS...\");\n  let css = generateTokensCss(\n    config.groups,\n    backgrounds,\n    config.borderTargets,\n    undefined,\n    config.palette\n  );\n\n  const stats = getKeyColorStats(config.anchors.keyColors);\n  if (\n    stats.chroma !== undefined ||\n    stats.hue !== undefined ||\n    stats.lightness !== undefined\n  ) {\n    const vars: string[] = [];\n    if (stats.chroma !== undefined)\n      vars.push(`  --chroma-brand: ${stats.chroma};`);\n    if (stats.hue !== undefined) vars.push(`  --hue-brand: ${stats.hue};`);\n    if (stats.lightness !== undefined)\n      vars.push(`  --lightness-brand: ${stats.lightness};`);\n\n    if (vars.length > 0) {\n      css = `:root {\\n${vars.join(\"\\n\")}\\n}\\n\\n` + css;\n    }\n  }\n\n  // --- High Contrast Generation ---\n  console.log(\"Generating High Contrast variant...\");\n  const hcConfig = toHighContrast(config);\n  const { backgrounds: hcBackgrounds } = solve(hcConfig);\n  const hcCss = generateTokensCss(\n    hcConfig.groups,\n    hcBackgrounds,\n    hcConfig.borderTargets,\n    undefined,\n    hcConfig.palette\n  );\n\n  // Wrap in media query and add overrides\n  const hcBlock = `\n@media (prefers-contrast: more) {\n  :root {\n    --base-chroma: 0;\n    --surface-chroma-adjust: 0;\n    --hue-adjust: 0;\n    --chroma-brand: 0;\n  }\n\n${hcCss}\n}\n`;\n\n  css += hcBlock;\n\n  console.log(\"Writing CSS to:\", BASE_CSS_PATH);\n  writeFileSync(BASE_CSS_PATH, css);\n  console.log(\"Done!\");\n}\n"]}