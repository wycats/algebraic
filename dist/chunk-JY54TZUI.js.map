{"version":3,"sources":["../src/lib/browser.ts"],"names":[],"mappings":"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","file":"chunk-JY54TZUI.js","sourcesContent":["/**\n * Updates the <meta name=\"theme-color\"> tag to match the computed background color\n * of the document body.\n *\n * Call this function whenever the theme changes (e.g. after switching modes).\n */\nexport function updateThemeColor(): void {\n  if (typeof document === \"undefined\") return;\n\n  let meta = document.querySelector('meta[name=\"theme-color\"]');\n  if (!meta) {\n    meta = document.createElement(\"meta\");\n    meta.setAttribute(\"name\", \"theme-color\");\n    document.head.appendChild(meta);\n  }\n\n  // Force a style recomputation to ensure we get the latest color\n  const color = getComputedStyle(document.body).backgroundColor;\n  if (color) {\n    meta.setAttribute(\"content\", color);\n  }\n}\n\n/**\n * Updates the favicon to match the current theme color.\n *\n * @param getSvg A function that returns an SVG string. It receives the current brand color as an argument.\n */\nexport function updateFavicon(getSvg: (color: string) => string): void {\n  if (typeof document === \"undefined\") return;\n\n  let link = document.querySelector('link[rel=\"icon\"]');\n  if (!link) {\n    link = document.createElement(\"link\");\n    link.setAttribute(\"rel\", \"icon\");\n    document.head.appendChild(link);\n  }\n\n  // We'll use the body's computed color (foreground) as the \"brand\" color for now\n  const color = getComputedStyle(document.body).color;\n\n  if (color) {\n    const svg = getSvg(color);\n    const dataUri = `data:image/svg+xml,${encodeURIComponent(svg)}`;\n    link.setAttribute(\"href\", dataUri);\n  }\n}\n\nexport type ThemeMode = \"light\" | \"dark\" | \"system\";\n\nexport interface ThemeManagerOptions {\n  /**\n   * The element to apply the theme to. Defaults to document.documentElement.\n   */\n  root?: HTMLElement;\n  /**\n   * The class to apply when the theme is 'light'.\n   * If not provided, sets style=\"color-scheme: light\".\n   */\n  lightClass?: string;\n  /**\n   * The class to apply when the theme is 'dark'.\n   * If not provided, sets style=\"color-scheme: dark\".\n   */\n  darkClass?: string;\n  /**\n   * A function to generate the favicon SVG based on the current theme color.\n   * If provided, the favicon will be updated automatically.\n   */\n  faviconGenerator?: (color: string) => string;\n}\n\nexport class ThemeManager {\n  private root: HTMLElement | null;\n  private lightClass?: string;\n  private darkClass?: string;\n  private faviconGenerator?: (color: string) => string;\n  private _mode: ThemeMode = \"system\";\n  private mediaQuery: MediaQueryList | null = null;\n\n  constructor(options: ThemeManagerOptions = {}) {\n    if (typeof document !== \"undefined\") {\n      this.root = options.root ?? document.documentElement;\n      this.lightClass = options.lightClass;\n      this.darkClass = options.darkClass;\n      this.faviconGenerator = options.faviconGenerator;\n      this.mediaQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n      this.mediaQuery.addEventListener(\"change\", this.handleSystemChange);\n    } else {\n      // Fallback for SSR/testing\n      this.root = null;\n    }\n  }\n\n  get mode(): ThemeMode {\n    return this._mode;\n  }\n\n  get resolvedMode(): \"light\" | \"dark\" {\n    if (this._mode === \"system\") {\n      if (this.mediaQuery) {\n        return this.mediaQuery.matches ? \"dark\" : \"light\";\n      }\n      return \"light\"; // Default fallback\n    }\n    return this._mode;\n  }\n\n  setMode(mode: ThemeMode): void {\n    this._mode = mode;\n    this.apply();\n    this.sync();\n  }\n\n  private handleSystemChange = (): void => {\n    if (this._mode === \"system\") {\n      this.sync();\n    }\n  };\n\n  private apply(): void {\n    if (!this.root) return;\n\n    // Remove existing classes/styles\n    if (this.lightClass) this.root.classList.remove(this.lightClass);\n    if (this.darkClass) this.root.classList.remove(this.darkClass);\n    this.root.style.removeProperty(\"color-scheme\");\n\n    if (this._mode === \"system\") {\n      // Do nothing, let browser default take over\n    } else if (this._mode === \"light\") {\n      if (this.lightClass) {\n        this.root.classList.add(this.lightClass);\n      } else {\n        this.root.style.setProperty(\"color-scheme\", \"light\");\n      }\n    } else {\n      // dark\n      if (this.darkClass) {\n        this.root.classList.add(this.darkClass);\n      } else {\n        this.root.style.setProperty(\"color-scheme\", \"dark\");\n      }\n    }\n  }\n\n  private sync(): void {\n    // Use requestAnimationFrame to ensure styles have been applied and computed\n    if (typeof requestAnimationFrame !== \"undefined\") {\n      requestAnimationFrame(() => {\n        updateThemeColor();\n        if (this.faviconGenerator) {\n          updateFavicon(this.faviconGenerator);\n        }\n      });\n    }\n  }\n\n  dispose(): void {\n    if (this.mediaQuery) {\n      this.mediaQuery.removeEventListener(\"change\", this.handleSystemChange);\n    }\n  }\n}\n"]}